Concept: Improvements to Secret Management System (over Vault) with a Different Low-Level Architecture and Security Model
---
The idea is to build something as functional as Vault but with a different underlying structure, particularly in terms of certain security aspects.

Below is a list of ideas in no particular logical order.

1. Most Secure Use Case: Wrapped Data for One-Time Access
    
    - Similar to wrapped tokens (but distinct from Vault’s access tokens).
    - The service itself does not need to know the content of these wrapped data objects to function.
    - Ideally, they are stored in an encrypted form, and even if stolen, they remain useless to the attacker.

2. Authentication Model: Only Asymmetric Keys

   - No external authentication methods besides asymmetric keys (including certificates).
   - No access tokens that could be intercepted—especially no root access tokens.
   - Instead of tokens, authentication is done via Private Key Challenge.

3. Seal/Unseal Mechanism

    - Uses init certificates instead of traditional Vault root tokens.
    - In the simplest case, each certificate should be able to decrypt the master key.
    - Alternatively, an extended Shamir’s Secret Sharing algorithm can be used, requiring a quorum of unseal admins (see Shamir’s Algorithm with PKI Support).

4. Reading Data: Public Key as Authenticator

    - A key pair is required to read secrets.
    - Before reading, the user must complete a challenge proving ownership of the private key corresponding to a known public key (authentication).
    - Ideally, retrieved data should be encrypted with the public key, ensuring only the private key holder can decrypt it.

5. Writing Data: Public Key of the Recipient Required

    - To write data, the writer must know the recipient’s public key.
    - PKI-based authentication is mandatory, but Kubernetes authentication is also allowed for internal writers.
    - Enhanced security can be achieved via a sidecar container approach:
    - The Wrapper Service also functions as an Injector (similar to Istio), managing internal certificates for sidecars.
    - This ensures mTLS-based internal communication security and provides an additional authentication factor for pods beyond JWT tokens—by verifying matching sidecar agent certificates.

6. Transient Installation: Different from Vault's Dev Mode

    Unlike Vault's dev mode, this transient mode retains full functionality without compromising security.
    If data persistence is not required, this installation can be used in production.